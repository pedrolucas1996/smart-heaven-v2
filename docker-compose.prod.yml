version: '3.8'

services:
  # FastAPI Backend (usa MySQL e MQTT externos)
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: smart-heaven-backend
    restart: unless-stopped
    environment:
      - DATABASE_URL=mysql+aiomysql://pedro:395967@192.168.31.153:3306/smartheaven
      - MQTT_HOST=192.168.31.153
      - MQTT_PORT=1883
    volumes:
      - ./backend:/app
    network_mode: host
    command: uvicorn src.main:app --host 0.0.0.0 --port 8000
